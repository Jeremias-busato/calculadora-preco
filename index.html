<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculadora de Preços</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: Arial, sans-serif;
      background-color: #ffffff;
      color: #000;
      padding: 20px;
    }
    .main-wrapper {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 20px;
      max-width: 1600px;
      margin: 0 auto;
    }
    .container {
      flex: 1;
      max-width: 600px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .header {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      margin-bottom: 10px;
    }
    .header img { max-height: 60px; margin-right: 10px; }
    .header h1 { font-size: 24px; }
    .input-container, .result-container {
      width: 100%;
      padding: 10px;
      border: 2px solid #000;
      border-radius: 10px;
      margin: 10px 0;
      background-color: #fff;
    }
    .input-container label {
      display: block;
      margin-top: 5px;
      font-size: 16px;
      text-align: left;
    }
    .input-container input {
      width: 100%;
      padding: 8px;
      font-size: 16px;
      margin-top: 5px;
    }
    .result-container { font-size: 16px; font-weight: bold; }
    .result-container table {
      width: 100%;
      border-collapse: collapse;
    }
    .result-container th, .result-container td {
      border: 1px solid #000;
      padding: 8px;
      text-align: center;
      font-weight: normal;
    }
    .result-container th { background-color: #eee; }
    .highlight { color: #ff6600; font-weight: bold; }
    .tabela-mao-de-obra {
      flex: 0 0 240px;
      border: 2px solid #000;
      border-radius: 10px;
      background-color: #f9f9f9;
      padding: 10px;
      height: fit-content;
      margin-top: 80px;
    }
    .tabela-mao-de-obra h2 {
      text-align: center;
      margin-bottom: 10px;
      font-size: 14px;
    }
    .tabela-mao-de-obra table {
      width: 100%;
      font-size: 12px;
      border-collapse: collapse.
    }
    .tabela-mao-de-obra th, .tabela-mao-de-obra td {
      border: 1px solid #000;
      padding: 4px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="main-wrapper">
    <div class="container">
      <div class="header">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSp51OGC2YtYl1F-J8L75fuHK3XhI9l7V898A&s" alt="Logo">
        <h1>Calculadora de Preços</h1>
      </div>
      <div class="input-container">
        <label>Digite o custo do produto (R$):</label>
        <input type="number" id="custo" oninput="calcular()" min="0" step="0.01">
        <label>Digite o valor da mão de obra (R$):</label>
        <input type="number" id="maoDeObra" oninput="calcular()" min="0" step="0.01">
        <label>Insira uma margem diferente da atual (%):</label>
        <input type="number" id="margemManual" oninput="calcular()" min="0" step="0.1">
      </div>
      <div class="result-container">
        <table>
          <thead>
            <tr><th>Tipo</th><th>% Margem</th><th>R$ Margem</th><th>Preço Final (R$)</th></tr>
          </thead>
          <tbody>
            <tr><td>Preço Cheio</td><td id="margemCheia">-</td><td id="precoMargemCheio">-</td><td id="precoCheio">-</td></tr>
            <tr><td>Preço Reduzido (-15%)</td><td id="margemReduzida">-</td><td id="precoMargemReduzido">-</td><td id="precoReduzido">-</td></tr>
            <tr id="maoDeObraCheioRow" style="display: none; font-weight:bold;"><td>Preço Cheio com Instalação</td><td id="margemCheiaInst">-</td><td id="precoMargemCheioInst">-</td><td id="precoCheioInstalacao" class="highlight">-</td></tr>
            <tr id="maoDeObraReduzidoRow" style="display: none;"><td>Preço Reduzido com Instalação</td><td id="margemReduzidaInst">-</td><td id="precoMargemReduzidoInst">-</td><td id="precoReduzidoInstalacao" class="highlight">-</td></tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="tabela-mao-de-obra">
      <h2>Tabela de Mão de Obra</h2>
      <table>
        <thead><tr><th>Horas</th><th>R$/h</th><th>Total</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>180,00</td><td>180,00</td></tr>
          <tr><td>2</td><td>170,00</td><td>340,00</td></tr>
          <tr><td>3</td><td>160,00</td><td>480,00</td></tr>
          <tr><td>4</td><td>150,00</td><td>600,00</td></tr>
          <tr><td>5</td><td>140,00</td><td>700,00</td></tr>
          <tr><td>6</td><td>135,00</td><td>810,00</td></tr>
          <tr><td>7</td><td>130,00</td><td>910,00</td></tr>
          <tr><td>8</td><td>125,00</td><td>1.000,00</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <script>
    // Converte número no formato PT-BR (milhar com ponto, decimal com vírgula) para Number
    function brToNumber(s) {
      return parseFloat(s.replace(/\./g, '').replace(',', '.'));
    }

    // --- CURVA NOVA (Custo x Venda), exatamente como você enviou ---
    const tabelaCSV = `
1,00 4,10
2,00 7,88
3,00 11,72
4,00 15,49
5,00 19,19
6,00 22,81
7,00 26,37
8,00 29,86
9,00 33,28
10,00 36,62
12,00 43,53
14,00 50,29
16,00 56,92
18,00 63,40
20,00 69,75
22,00 75,95
24,00 82,02
26,00 87,94
28,00 93,72
30,00 99,37
33,00 108,15
36,00 116,72
39,00 125,09
42,00 133,24
45,00 141,18
48,00 148,91
51,00 156,43
54,00 163,74
57,00 170,85
60,00 177,74
64,00 187,35
68,00 196,68
72,00 205,73
76,00 214,50
80,00 222,98
84,00 231,19
88,00 239,12
92,00 246,77
96,00 254,14
100,00 261,23
105,00 270,62
110,00 279,65
115,00 288,34
120,00 296,68
125,00 304,66
130,00 312,30
135,00 319,59
140,00 326,52
145,00 333,11
150,00 339,35
155,00 345,23
160,00 350,77
165,00 355,96
170,00 360,79
175,00 365,28
180,00 369,42
185,00 373,20
190,00 376,64
195,00 379,72
200,00 384,46
210,00 398,43
220,00 411,91
230,00 424,88
240,00 437,35
250,00 449,33
260,00 460,80
270,00 471,77
280,00 482,25
290,00 492,22
300,00 504,69
310,00 516,87
320,00 528,74
330,00 540,31
340,00 551,58
350,00 562,56
360,00 573,23
370,00 583,60
380,00 593,68
390,00 603,45
400,00 614,92
410,00 626,20
420,00 637,27
430,00 648,14
440,00 658,82
450,00 671,54
460,00 684,16
470,00 696,68
480,00 709,11
490,00 721,43
500,00 734,65
520,00 762,48
540,00 790,19
560,00 817,77
580,00 845,24
600,00 873,18
620,00 901,05
640,00 928,84
660,00 956,54
680,00 984,17
700,00 1.011,72
720,00 1.039,18
740,00 1.066,57
760,00 1.093,87
780,00 1.121,10
800,00 1.148,25
820,00 1.175,31
840,00 1.202,30
860,00 1.229,20
880,00 1.256,03
900,00 1.282,78
920,00 1.309,44
940,00 1.336,03
960,00 1.362,54
980,00 1.388,96
1.000,00 1.417,31
1.050,00 1.488,17
1.100,00 1.559,04
1.150,00 1.629,90
1.200,00 1.700,77
1.250,00 1.771,63
1.300,00 1.842,50
1.350,00 1.913,37
1.400,00 1.984,23
1.450,00 2.055,10
1.500,00 2.125,96
1.550,00 2.196,83
1.600,00 2.267,69
1.650,00 2.338,56
1.700,00 2.409,42
1.750,00 2.480,29
1.800,00 2.551,15
1.850,00 2.622,02
1.900,00 2.692,88
1.950,00 2.763,75
2.000,00 2.834,62
2.050,00 2.905,48
2.100,00 2.976,35
2.150,00 3.047,21
2.200,00 3.118,08
2.250,00 3.188,94
2.300,00 3.259,81
2.350,00 3.330,67
2.400,00 3.401,54
2.450,00 3.472,40
2.500,00 3.543,27
2.550,00 3.614,13
2.600,00 3.685,00
2.650,00 3.755,87
2.700,00 3.826,73
2.750,00 3.897,60
2.800,00 3.968,46
2.850,00 4.039,33
2.900,00 4.110,19
2.950,00 4.181,06
3.000,00 4.251,92
3.050,00 4.322,79
3.100,00 4.393,65
3.150,00 4.464,52
3.200,00 4.535,38
3.250,00 4.606,25
3.300,00 4.677,12
3.350,00 4.747,98
3.400,00 4.818,85
3.450,00 4.889,71
3.500,00 4.960,58
3.550,00 5.031,44
3.600,00 5.102,31
3.650,00 5.173,17
3.700,00 5.244,04
3.750,00 5.314,90
3.800,00 5.385,77
3.850,00 5.456,63
3.900,00 5.527,50
3.950,00 5.598,37
4.000,00 5.669,23
4.050,00 5.740,10
4.100,00 5.810,96
4.150,00 5.881,83
4.200,00 5.952,69
4.250,00 6.023,56
4.300,00 6.094,42
4.350,00 6.165,29
4.400,00 6.236,15
4.450,00 6.307,02
4.500,00 6.377,88
4.550,00 6.448,75
4.600,00 6.519,62
4.650,00 6.590,48
4.700,00 6.661,35
4.750,00 6.732,21
4.800,00 6.803,08
4.850,00 6.873,94
4.900,00 6.944,81
4.950,00 7.015,67
5.000,00 7.086,54
5.100,00 7.228,27
5.200,00 7.370,00
5.300,00 7.511,73
5.400,00 7.653,46
5.500,00 7.795,19
5.600,00 7.936,92
5.700,00 8.078,65
5.800,00 8.220,38
5.900,00 8.362,12
6.000,00 8.503,85
6.100,00 8.645,58
6.200,00 8.787,31
6.300,00 8.929,04
6.400,00 9.070,77
6.500,00 9.212,50
6.600,00 9.354,23
6.700,00 9.495,96
6.800,00 9.637,69
6.900,00 9.779,42
7.000,00 9.921,15
7.100,00 10.062,88
7.200,00 10.204,62
7.300,00 10.346,35
7.400,00 10.488,08
7.500,00 10.629,81
7.600,00 10.771,54
7.700,00 10.913,27
7.800,00 11.055,00
7.900,00 11.196,73
8.000,00 11.338,46
8.100,00 11.480,19
8.200,00 11.621,92
8.300,00 11.763,65
8.400,00 11.905,38
8.500,00 12.047,12
8.600,00 12.188,85
8.700,00 12.330,58
8.800,00 12.472,31
8.900,00 12.614,04
9.000,00 12.755,77
9.100,00 12.897,50
9.200,00 13.039,23
9.300,00 13.180,96
9.400,00 13.322,69
9.500,00 13.464,42
9.600,00 13.606,15
9.700,00 13.747,88
9.800,00 13.889,62
9.900,00 14.031,35
10.000,00 14.173,08
10.100,00 14.314,81
10.200,00 14.456,54
10.300,00 14.598,27
10.400,00 14.740,00
10.500,00 14.881,73
10.600,00 15.023,46
10.700,00 15.165,19
10.800,00 15.306,92
10.900,00 15.448,65
11.000,00 15.590,38
11.100,00 15.732,12
11.200,00 15.873,85
11.300,00 16.015,58
11.400,00 16.157,31
11.500,00 16.299,04
11.600,00 16.440,77
11.700,00 16.582,50
11.800,00 16.724,23
11.900,00 16.865,96
12.000,00 17.007,69
`;

    // Monta a tabela numérica [custo, venda] a partir do texto acima
    const tabela = tabelaCSV
      .trim()
      .split('\n')
      .map(linha => {
        const [custoStr, vendaStr] = linha.trim().split(/\s+/);
        return [brToNumber(custoStr), brToNumber(vendaStr)];
      });

    // Interpolação linear (com extrapolação proporcional acima do último ponto)
    function interpolar(x) {
      for (let i = 0; i < tabela.length - 1; i++) {
        const [x1, y1] = tabela[i];
        const [x2, y2] = tabela[i+1];
        if (x >= x1 && x <= x2) return y1 + (y2 - y1) * ((x - x1) / (x2 - x1));
      }
      // extrapola proporcionalmente a partir do último ponto
      return tabela[tabela.length - 1][1] * (x / tabela[tabela.length - 1][0]);
    }

    function calcular() {
      let custo = parseFloat(document.getElementById("custo").value);
      let maoDeObra = parseFloat(document.getElementById("maoDeObra").value) || 0;
      let margemManual = parseFloat(document.getElementById("margemManual").value);
      if (!custo || custo <= 0) return;

      // Preço cheio: usa margem manual se fornecida, senão usa a curva por interpolação
      let precoCheio = margemManual ? custo * (1 + margemManual / 100) : interpolar(custo);
      // Arredonda para terminar em 7 (ceil para a próxima dezena, menos 3 -> ...7)
      precoCheio = Math.ceil(precoCheio / 10) * 10 - 3;

      let margemAtual = ((precoCheio - custo) / custo) * 100;

      // Redução de margem em 15% (mantida como já estava)
      let margemReduzida = margemAtual * 0.85;
      let precoReduzido = custo * (1 + margemReduzida / 100);
      precoReduzido = Math.ceil(precoReduzido / 10) * 10 - 3;

      // Exibir resultados de preço cheio e reduzido
      document.getElementById("margemCheia").innerText = margemManual ? margemManual.toFixed(2) + '%' : margemAtual.toFixed(2) + '%';
      document.getElementById("precoMargemCheio").innerText = "R$ " + (precoCheio - custo).toFixed(2);
      document.getElementById("precoCheio").innerText = "R$ " + precoCheio.toFixed(2);

      document.getElementById("margemReduzida").innerText = margemReduzida.toFixed(2) + '%';
      document.getElementById("precoMargemReduzido").innerText = "R$ " + (precoReduzido - custo).toFixed(2);
      document.getElementById("precoReduzido").innerText = "R$ " + precoReduzido.toFixed(2);

      // Calcular preço com instalação
      if (maoDeObra > 0) {
        document.getElementById("maoDeObraCheioRow").style.display = 'table-row';
        document.getElementById("maoDeObraReduzidoRow").style.display = 'table-row';

        let precoCheioInstalacao = precoCheio + maoDeObra;
        let precoReduzidoInstalacao = precoReduzido + maoDeObra;

        document.getElementById("precoCheioInstalacao").innerText = "R$ " + precoCheioInstalacao.toFixed(2);
        document.getElementById("precoReduzidoInstalacao").innerText = "R$ " + precoReduzidoInstalacao.toFixed(2);

        let margemCheiaInst = ((precoCheioInstalacao - custo) / custo) * 100;
        let margemReduzidaInst = ((precoReduzidoInstalacao - custo) / custo) * 100;

        document.getElementById("margemCheiaInst").innerText = margemCheiaInst.toFixed(2) + '%';
        document.getElementById("margemReduzidaInst").innerText = margemReduzidaInst.toFixed(2) + '%';
        document.getElementById("precoMargemCheioInst").innerText = "R$ " + (precoCheioInstalacao - custo).toFixed(2);
        document.getElementById("precoMargemReduzidoInst").innerText = "R$ " + (precoReduzidoInstalacao - custo).toFixed(2);
      } else {
        document.getElementById("maoDeObraCheioRow").style.display = 'none';
        document.getElementById("maoDeObraReduzidoRow").style.display = 'none';
      }
    }
  </script>
</body>
</html>
